<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
       "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <title><%= basics[:name] %> - 株色新聞</title>
  <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
  <style>
    * {font-size:12px;}
    #container {margin:0 auto;}
    #logo a {font-size:1.5em; text-decoration:none; font-weight:bold; color:#0080FF;}
    #stockchart {width:512px;}
    h1 {font-size:1.2em;}
    .range {font-size:10px;}
    .label {margin-top:2px;}
    .range .label {color:#222; font-weight:bold;}
    .chart {background-color:blue; float:left; box-shadow:1px 2px 4px 1px #333;}
    .chart span {visibility:hidden;}
    .tag {float:left; margin-left:8px; color:#888; font-weight:bold;}
    .span a {text-decoration:undefline;}
    .separator {color:#888;}
    .spanlist {text-align:center;}
    .graph-label {text-align:center; font-weight:bold;}
    .graph {height: 301px;}
    .graph .loading {background: url(./ajax-loader.gif) no-repeat center center;}
    .ord {text-align:right;}
  </style>
<!--   <script src="http://code.jquery.com/jquery-latest.js"></script> -->
  <script src="./jquery.min.js"></script>
  <script>
    var spans = [
	{"span":"1日", "iurl":"http://gchart.yahoo.co.jp/b?s=2432.T&t=1y&q=c&l=off&z=m&p=m65,m130,s&a=v&c="},
	{"span":"1週", "iurl":"http://gchart.yahoo.co.jp/w?s=2432.T&t=1y&q=c&l=off&z=m&p=m65,m130,s&a=v&c="},
	{"span":"1ヶ月", "iurl":"http://gchart.yahoo.co.jp/z?s=2432.T&t=1m&q=c&l=off&z=m&p=m65,m130,s&a=v&c="},
	{"span":"3ヶ月", "iurl":"http://gchart.yahoo.co.jp/z?s=2432.T&t=3m&q=c&l=off&z=m&p=m65,m130,s&a=v&c="},
	{"span":"6ヶ月", "iurl":"http://gchart.yahoo.co.jp/z?s=2432.T&t=6m&q=c&l=off&z=m&p=m65,m130,s&a=v&c="},
	{"span":"1年", "iurl":"http://gchart.yahoo.co.jp/z?s=2432.T&t=1y&q=c&l=off&z=m&p=m65,m130,s&a=v&c="},
	{"span":"2年", "iurl":"http://gchart.yahoo.co.jp/z?s=2432.T&t=2y&q=c&l=off&z=m&p=m65,m130,s&a=v&c="},
	{"span":"5年", "iurl":"http://gchart.yahoo.co.jp/z?s=2432.T&t=5y&q=c&l=off&z=m&p=m65,m130,s&a=v&c="},
	{"span":"10年", "iurl":"http://gchart.yahoo.co.jp/z?s=2432.T&t=ay&q=c&l=off&z=m&p=m65,m130,s&a=v&c="}
    ];
    function set_chart(idx) {
	$("#stockchart .graph-label").text(spans[idx]["span"] + "チャート");
        $("#stockchart .graph").html('<a href="http://stocks.finance.yahoo.co.jp/stocks/detail/?code=<%= basics[:symbol] %>.<%= basics[:exchange] %>"><img src="' + spans[idx]["iurl"] + '" />');
    }
    window.onload = function() {
	set_chart(5);
	for (var i = 0; i < spans.length; i++) {
	    if (i > 0) $("#stockchart .spanlist").append('<span class="separator">|</span>');
	    $("#stockchart .spanlist").append('<span class="span"><a onclick="set_chart(' + i + ')">' + spans[i]["span"] + '</a></span>');
	}
    }
  </script>
</head>

<body>
  <div id="header">
    <div id="logo"><a href="http://jp.sugyoku.com/">株色新聞</a></div>
    <a href="https://twitter.com/share" class="twitter-share-button" data-url="ZZZZZZ" data-count="horizontal">Tweet</a><script type="text/javascript" src="//platform.twitter.com/widgets.js"></script>
    <iframe src="//www.facebook.com/plugins/like.php?href&amp;send=false&amp;layout=button_count&amp;width=450&amp;show_faces=true&amp;action=like&amp;colorscheme=light&amp;font&amp;height=21&amp;appId=189373767787690" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:450px; height:21px;" allowTransparency="true"></iframe>
  </div>
  <div id="container">
    <h1><%= basics[:name] %>(<%= basics[:symbol] %>)</h1>

    <div id="stockchart">
      <div class="graph-label"></div>
      <div class="graph">
      </div>
      <div class="spanlist">
      </div>
    </div>
    
    <h2>値動きの似ている銘柄</h2>
    <table>
    <% correlated.each do |t| %>
    <tr>
      <td class="ord"><%= t[:ord] %>.</td>
      <td class="name"><a href="<%= t[:symbol] %>.html"><%= t[:name] %></a></td>

      <td class="cor"><%= "%.3f" % t[:cor] %></td>
    </tr>
    <% end %>
    </table>
    
    <% if estimated_ave %>
    <h2><%= basics[:name] %>株保有者の予想損益率</h2>
    <div>予想平均購入価格：<%= "%.1f" % estimated_ave %>円(-12.34%)</div>
    <table>
      <% estimated_histogram.each do |range, value| %>
      <tr>
      <tr class="range">
	<td class="label"><%= range %></td>
	<td>
	  <% width = (280 * value).to_i %>
	  <% if width > 0 %>
	  <div class="chart" style="width:<%= width %>px;"><span>.</span></div>
	  <% end %>
	  <div class="label tag"><%= "%.1f%%" % (100 * value) %></div>
	</td>
      </tr>
      </tr>
      <% end %>
    </table>
    <% end %>
    
    <h2></h2>
  </div>

  <div id="footer">
    <a href="http://jp.sugyoku.com">Home</a> ©株色新聞 ご意見・ご要望は<a href="http://twitter.com/kabushinbun">@kabushinbun</a>へ
  </div>
</body>

</html>
